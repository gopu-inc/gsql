name: ğŸ Publication PyPI

on:
  push:
    branches: main

jobs:
  pypi:
    runs-on: ubuntu-latest
    
    steps:
      - name: ğŸ“¥ Checkout
        uses: actions/checkout@v4
      
      - name: ğŸ·ï¸ Lire version du tag
        id: version
        run: |
          VERSION="${GITHUB_REF#refs/tags/v}"
          echo "VERSION=$VERSION" >> $GITHUB_ENV
          echo "ğŸ“¦ Version PyPI: $VERSION"
      
      - name: ğŸ Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'
      
      - name: ğŸ“¦ Installer build
        run: pip install build
      
      - name: ğŸ—ï¸ Build Package
        run: python -m build
      
      - name: ğŸ“¤ Upload PyPI
        uses: pypa/gh-action-pypi-publish@release/v1
        with:
          password: ${{ secrets.PYPI_TOKEN }}
      
      - name: âœ… Confirmation
        run: echo "âœ… PyPI: gsql==${{ env.VERSION }} publiÃ©"
